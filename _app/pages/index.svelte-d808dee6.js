import{S as t,i as e,s as n,e as a,c as l,a as r,d as o,K as s,f as c,J as i,L as u,A as d,M as h,N as f,t as m,k as p,g,n as v,F as y,j as x,O as k,m as E,P,b as $,o as b,Q as w,R as L,T as _,U as I,x as j,u as z,v as N,V,W as C,X as D,h as R,Y as T,l as A,Z as O}from"../chunks/vendor-5ba98aa4.js";function M(t){let e;return{c(){e=a("div"),this.h()},l(t){e=l(t,"DIV",{style:!0}),r(e).forEach(o),this.h()},h(){s(e,"height","80vh"),s(e,"border","1px solid grey")},m(n,a){c(n,e,a),t[3](e)},p:i,i:i,o:i,d(n){n&&o(e),t[3](null)}}}function S(t,e,n){const a=u();let l,r,{text:o=""}=e;const s={value:o,language:"ruby",automaticLayout:!0};return d((()=>{require.config({paths:{vs:"https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.26.1/min/vs"}}),require(["vs/editor/editor.main"],(t=>{l=t.editor.create(r,s),n(1,o=l.getModel().getValue()),l.getModel().onDidChangeContent((t=>{n(1,o=l.getModel().getValue())})),a("ready",{})}))})),t.$$set=t=>{"text"in t&&n(1,o=t.text)},[r,o,function(t){if(l)return l.getModel().setValue(t)},function(t){h[t?"unshift":"push"]((()=>{r=t,n(0,r)}))}]}class q extends t{constructor(t){super(),e(this,t,S,M,n,{text:1,set_text:2})}get set_text(){return this.$$.ctx[2]}}function J(t,e,n){const a=t.slice();return a[21]=e[n],a}function U(t,e,n){const a=t.slice();return a[24]=e[n],a}function W(t){let e,n,s,u,d=t[24].title+"";return{c(){e=a("option"),n=m(d),s=p(),this.h()},l(t){e=l(t,"OPTION",{});var a=r(e);n=g(a,d),s=v(a),a.forEach(o),this.h()},h(){e.__value=u=t[24].name,e.value=e.__value},m(t,a){c(t,e,a),y(e,n),y(e,s)},p:i,d(t){t&&o(e)}}}function B(t){let e,n,s=t[5],i=[];for(let a=0;a<s.length;a+=1)i[a]=X(J(t,s,a));return{c(){e=m("Please wait, loading...\n\t\t"),n=a("ul");for(let t=0;t<i.length;t+=1)i[t].c()},l(t){e=g(t,"Please wait, loading...\n\t\t"),n=l(t,"UL",{});var a=r(n);for(let e=0;e<i.length;e+=1)i[e].l(a);a.forEach(o)},m(t,a){c(t,e,a),c(t,n,a);for(let e=0;e<i.length;e+=1)i[e].m(n,null)},p(t,e){if(32&e){let a;for(s=t[5],a=0;a<s.length;a+=1){const l=J(t,s,a);i[a]?i[a].p(l,e):(i[a]=X(l),i[a].c(),i[a].m(n,null))}for(;a<i.length;a+=1)i[a].d(1);i.length=s.length}},d(t){t&&o(e),t&&o(n),V(i,t)}}}function H(t){let e,n,a={ctx:t,current:null,token:null,hasCatch:!0,pending:et,then:K,catch:F,error:21};return T(n=t[3],a),{c(){e=A(),a.block.c()},l(t){e=A(),a.block.l(t)},m(t,n){c(t,e,n),a.block.m(t,a.anchor=n),a.mount=()=>e.parentNode,a.anchor=e},p(e,l){t=e,a.ctx=t,8&l&&n!==(n=t[3])&&T(n,a)||O(a,t,l)},d(t){t&&o(e),a.block.d(t),a.token=null,a=null}}}function X(t){let e,n,s=t[21]+"";return{c(){e=a("li"),n=m(s)},l(t){e=l(t,"LI",{});var a=r(e);n=g(a,s),a.forEach(o)},m(t,a){c(t,e,a),y(e,n)},p(t,e){32&e&&s!==(s=t[21]+"")&&R(n,s)},d(t){t&&o(e)}}}function F(t){let e,n,s=t[21]+"";return{c(){e=a("pre"),n=m(s)},l(t){e=l(t,"PRE",{});var a=r(e);n=g(a,s),a.forEach(o)},m(t,a){c(t,e,a),y(e,n)},p(t,e){8&e&&s!==(s=t[21]+"")&&R(n,s)},d(t){t&&o(e)}}}function K(t){let e,n,a={ctx:t,current:null,token:null,hasCatch:!0,pending:tt,then:Y,catch:Q,value:20,error:21};return T(n=t[4],a),{c(){e=A(),a.block.c()},l(t){e=A(),a.block.l(t)},m(t,n){c(t,e,n),a.block.m(t,a.anchor=n),a.mount=()=>e.parentNode,a.anchor=e},p(e,l){t=e,a.ctx=t,16&l&&n!==(n=t[4])&&T(n,a)||O(a,t,l)},d(t){t&&o(e),a.block.d(t),a.token=null,a=null}}}function Q(t){let e,n,s=t[21]+"";return{c(){e=a("pre"),n=m(s)},l(t){e=l(t,"PRE",{});var a=r(e);n=g(a,s),a.forEach(o)},m(t,a){c(t,e,a),y(e,n)},p(t,e){16&e&&s!==(s=t[21]+"")&&R(n,s)},d(t){t&&o(e)}}}function Y(t){let e;function n(t,e){return"Tree"==t[20].type?G:Z}let a=n(t),l=a(t);return{c(){l.c(),e=A()},l(t){l.l(t),e=A()},m(t,n){l.m(t,n),c(t,e,n)},p(t,r){a===(a=n(t))&&l?l.p(t,r):(l.d(1),l=a(t),l&&(l.c(),l.m(e.parentNode,e)))},d(t){l.d(t),t&&o(e)}}}function Z(t){let e,n=t[20]+"";return{c(){e=m(n)},l(t){e=g(t,n)},m(t,n){c(t,e,n)},p(t,a){16&a&&n!==(n=t[20]+"")&&R(e,n)},d(t){t&&o(e)}}}function G(t){let e,n,s=t[20].pretty()+"";return{c(){e=a("pre"),n=m(s)},l(t){e=l(t,"PRE",{});var a=r(e);n=g(a,s),a.forEach(o)},m(t,a){c(t,e,a),y(e,n)},p(t,e){16&e&&s!==(s=t[20].pretty()+"")&&R(n,s)},d(t){t&&o(e)}}}function tt(t){let e;return{c(){e=m("Parsing...")},l(t){e=g(t,"Parsing...")},m(t,n){c(t,e,n)},p:i,d(t){t&&o(e)}}}function et(t){let e;return{c(){e=m("Building Parser...")},l(t){e=g(t,"Building Parser...")},m(t,n){c(t,e,n)},p:i,d(t){t&&o(e)}}}function nt(t){let e,n,s,i,u,d,D,R,T,A,O,M,S,J,X,F;function K(e){t[12](e)}let Q={id:"grammar"};void 0!==t[0]&&(Q.text=t[0]),i=new q({props:Q}),t[11](i),h.push((()=>f(i,"text",K))),i.$on("ready",t[9]);let Y=t[8],Z=[];for(let a=0;a<Y.length;a+=1)Z[a]=W(U(t,Y,a));function G(t,e){return t[2]?H:B}let tt=G(t),et=tt(t);return{c(){e=p(),n=a("section"),s=a("div"),x(i.$$.fragment),d=p(),D=a("div"),R=m("Load grammar:\n\t\t\t"),T=a("select");for(let t=0;t<Z.length;t+=1)Z[t].c();A=p(),O=a("textarea"),M=p(),S=a("div"),et.c(),this.h()},l(t){k('[data-svelte="svelte-3fm5e0"]',document.head).forEach(o),e=v(t),n=l(t,"SECTION",{id:!0,class:!0});var a=r(n);s=l(a,"DIV",{id:!0,class:!0});var c=r(s);E(i.$$.fragment,c),d=v(c),D=l(c,"DIV",{});var u=r(D);R=g(u,"Load grammar:\n\t\t\t"),T=l(u,"SELECT",{});var h=r(T);for(let e=0;e<Z.length;e+=1)Z[e].l(h);h.forEach(o),u.forEach(o),c.forEach(o),A=v(a),O=l(a,"TEXTAREA",{id:!0,class:!0}),r(O).forEach(o),M=v(a),S=l(a,"DIV",{id:!0,class:!0});var f=r(S);et.l(f),f.forEach(o),a.forEach(o),this.h()},h(){document.title="Lark IDE",void 0===t[6]&&P((()=>t[13].call(T))),$(s,"id","grammar_pane"),$(s,"class","svelte-13zzwm7"),$(O,"id","text"),$(O,"class","svelte-13zzwm7"),$(S,"id","output"),$(S,"class","svelte-13zzwm7"),$(n,"id","ide"),$(n,"class","svelte-13zzwm7")},m(a,l){c(a,e,l),c(a,n,l),y(n,s),b(i,s,null),y(s,d),y(s,D),y(D,R),y(D,T);for(let t=0;t<Z.length;t+=1)Z[t].m(T,null);w(T,t[6]),y(n,A),y(n,O),L(O,t[1]),y(n,M),y(n,S),et.m(S,null),J=!0,X||(F=[_(T,"change",t[13]),_(T,"change",t[10]),_(O,"input",t[14])],X=!0)},p(t,[e]){const n={};if(!u&&1&e&&(u=!0,n.text=t[0],I((()=>u=!1))),i.$set(n),256&e){let n;for(Y=t[8],n=0;n<Y.length;n+=1){const a=U(t,Y,n);Z[n]?Z[n].p(a,e):(Z[n]=W(a),Z[n].c(),Z[n].m(T,null))}for(;n<Z.length;n+=1)Z[n].d(1);Z.length=Y.length}320&e&&w(T,t[6]),2&e&&L(O,t[1]),tt===(tt=G(t))&&et?et.p(t,e):(et.d(1),et=tt(t),et&&(et.c(),et.m(S,null)))},i(t){J||(j(i.$$.fragment,t),J=!0)},o(t){z(i.$$.fragment,t),J=!1},d(a){a&&o(e),a&&o(n),t[11](null),N(i),V(Z,a),et.d(),X=!1,C(F)}}}const at=!0;function lt(t,e,n){let a;var l=this&&this.__awaiter||function(t,e,n,a){return new(n||(n=Promise))((function(l,r){function o(t){try{c(a.next(t))}catch(e){r(e)}}function s(t){try{c(a.throw(t))}catch(e){r(e)}}function c(t){var e;t.done?l(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}c((a=a.apply(t,e||[])).next())}))};const r=[{title:"(easy) Hello World",name:"hello",text:"Hello, World!"},{title:"(easy) JSON parser",name:"json",text:'{"this": ["is", "JSON"]}'},{title:"(easy) Calculator",name:"calc",text:"20 / (13 - 6) + 1"}];let o,s,{grammar:c,options:i,text:u}=r[0],d=[];let f,m="hello";function p(){return l(this,void 0,void 0,(function*(){console.log("Loading grammar",m);let t=yield fetch("grammars/"+m+".lark");if(t.ok){n(0,c=yield t.text()),f.set_text(c);for(let t of r)if(t.name===m){n(1,u=t.text);break}}}))}return t.$$.update=()=>{var e,l,r;5&t.$$.dirty&&n(3,a=s&&(e=c,l=i,s.globals.set("grammar",e),s.globals.set("options",l||{}),s.runPythonAsync("parser = lark.Lark(grammar, **options.to_py())"))),14&t.$$.dirty&&n(4,o=s&&a&&(r=u,s.globals.set("text",r),s.runPythonAsync("parser.parse(text)")))},[c,u,s,a,o,d,m,f,r,function(){return l(this,void 0,void 0,(function*(){var t,e;p(),s||(t=t=>{n(2,s=t)},(e=t=>{n(5,d=[...d,t])})&&e("Loading Pyodide"),require(["https://cdn.jsdelivr.net/pyodide/v0.18.0/full/pyodide.js"],(n=>{n.loadPyodide({indexURL:"https://cdn.jsdelivr.net/pyodide/v0.18.0/full/"}).then((async n=>{console.log("Pyodide loaded",n),e&&e("Installing micropip"),await n.loadPackage("micropip"),e&&e("Downloading & Installing Lark"),await n.runPythonAsync("import micropip; await micropip.install('lark-parser');"),n.runPython("import lark"),t(n),console.log("Ready!",n)}))})))}))},p,function(t){h[t?"unshift":"push"]((()=>{f=t,n(7,f)}))},function(t){c=t,n(0,c)},function(){m=D(this),n(6,m),n(8,r)},function(){u=this.value,n(1,u)}]}class rt extends t{constructor(t){super(),e(this,t,lt,nt,n,{})}}export{rt as default,at as prerender};
