var t=Object.defineProperty,e=Object.defineProperties,n=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,o=(e,n,r)=>n in e?t(e,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[n]=r;import{S as s,i,s as c,e as u,c as d,a as f,d as h,K as p,f as v,J as m,L as g,A as y,M as x,t as E,k as $,g as _,n as b,b as k,F as P,N as L,O as I,P as O,j as w,Q as j,m as D,R as V,o as A,T as N,U as R,V as T,x as C,u as S,v as M,W as U,X as B,h as q,Y as J,l as W,Z as H}from"../chunks/vendor-8f9d1cf9.js";function X(t){let e;return{c(){e=u("div"),this.h()},l(t){e=d(t,"DIV",{style:!0}),f(e).forEach(h),this.h()},h(){p(e,"height","80vh"),p(e,"border","1px solid grey")},m(n,r){v(n,e,r),t[3](e)},p:m,i:m,o:m,d(n){n&&h(e),t[3](null)}}}function F(t,e,n){const r=g();let a,l,{text:o=""}=e;const s={value:o,language:"ruby",automaticLayout:!0};return y((()=>{require.config({paths:{vs:"https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.26.1/min/vs"}}),require(["vs/editor/editor.main"],(t=>{a=t.editor.create(l,s),n(1,o=a.getModel().getValue()),a.getModel().onDidChangeContent((t=>{n(1,o=a.getModel().getValue())})),r("ready",{})}))})),t.$$set=t=>{"text"in t&&n(1,o=t.text)},[l,o,function(t){if(a)return a.getModel().setValue(t)},function(t){x[t?"unshift":"push"]((()=>{l=t,n(0,l)}))}]}class K extends s{constructor(t){super(),i(this,t,F,X,c,{text:1,set_text:2})}get set_text(){return this.$$.ctx[2]}}function Q(t){let e,n,r,a,l,o,s,i,c,p,g,y,x,O,w,j,D,V;return{c(){e=u("div"),n=u("div"),r=u("div"),a=E("Parser:"),l=$(),o=u("div"),s=u("input"),i=$(),c=u("label"),p=E("Earley"),g=$(),y=u("div"),x=u("input"),O=$(),w=u("label"),j=E("LALR(1)"),this.h()},l(t){e=d(t,"DIV",{id:!0});var u=f(e);n=d(u,"DIV",{class:!0});var v=f(n);r=d(v,"DIV",{});var m=f(r);a=_(m,"Parser:"),m.forEach(h),l=b(v),o=d(v,"DIV",{});var E=f(o);s=d(E,"INPUT",{type:!0,id:!0,name:!0}),i=b(E),c=d(E,"LABEL",{for:!0});var $=f(c);p=_($,"Earley"),$.forEach(h),E.forEach(h),g=b(v),y=d(v,"DIV",{});var k=f(y);x=d(k,"INPUT",{type:!0,id:!0,name:!0}),O=b(k),w=d(k,"LABEL",{for:!0});var P=f(w);j=_(P,"LALR(1)"),P.forEach(h),k.forEach(h),v.forEach(h),u.forEach(h),this.h()},h(){k(s,"type","radio"),k(s,"id","earley"),k(s,"name","parser"),s.__value="earley",s.value=s.__value,s.checked=!0,t[4][0].push(s),k(c,"for","earley"),k(x,"type","radio"),k(x,"id","lalr"),k(x,"name","parser"),x.__value="lalr",x.value=x.__value,t[4][0].push(x),k(w,"for","lalr"),k(n,"class","option svelte-fi2lts"),k(e,"id","options")},m(u,d){v(u,e,d),P(e,n),P(n,r),P(r,a),P(n,l),P(n,o),P(o,s),s.checked=s.__value===t[0],P(o,i),P(o,c),P(c,p),P(n,g),P(n,y),P(y,x),x.checked=x.__value===t[0],P(y,O),P(y,w),P(w,j),D||(V=[L(s,"input",t[1]),L(s,"change",t[3]),L(x,"input",t[1]),L(x,"change",t[5])],D=!0)},p(t,[e]){1&e&&(s.checked=s.__value===t[0]),1&e&&(x.checked=x.__value===t[0])},i:m,o:m,d(n){n&&h(e),t[4][0].splice(t[4][0].indexOf(s),1),t[4][0].splice(t[4][0].indexOf(x),1),D=!1,I(V)}}}function Y(t,s,i){let c,{options:u}=s;return t.$$set=t=>{"options"in t&&i(2,u=t.options)},t.$$.update=()=>{4&t.$$.dirty&&u&&i(0,c=u.parser)},[c,function(t){var s,c;i(2,(s=((t,e)=>{for(var n in e||(e={}))a.call(e,n)&&o(t,n,e[n]);if(r)for(var n of r(e))l.call(e,n)&&o(t,n,e[n]);return t})({},u),c={parser:t.target.value},u=e(s,n(c))))},u,function(){c=this.__value,i(0,c)},[[]],function(){c=this.__value,i(0,c)}]}class Z extends s{constructor(t){super(),i(this,t,Y,Q,c,{options:2})}}function z(t,e,n){const r=t.slice();return r[23]=e[n],r}function G(t,e,n){const r=t.slice();return r[26]=e[n],r}function tt(t){let e,n,r,a,l=t[26].title+"";return{c(){e=u("option"),n=E(l),r=$(),this.h()},l(t){e=d(t,"OPTION",{});var a=f(e);n=_(a,l),r=b(a),a.forEach(h),this.h()},h(){e.__value=a=t[26].name,e.value=e.__value},m(t,a){v(t,e,a),P(e,n),P(e,r)},p:m,d(t){t&&h(e)}}}function et(t){let e,n,r=t[6],a=[];for(let l=0;l<r.length;l+=1)a[l]=rt(z(t,r,l));return{c(){e=E("Please wait, loading...\n\t\t"),n=u("ul");for(let t=0;t<a.length;t+=1)a[t].c()},l(t){e=_(t,"Please wait, loading...\n\t\t"),n=d(t,"UL",{});var r=f(n);for(let e=0;e<a.length;e+=1)a[e].l(r);r.forEach(h)},m(t,r){v(t,e,r),v(t,n,r);for(let e=0;e<a.length;e+=1)a[e].m(n,null)},p(t,e){if(64&e){let l;for(r=t[6],l=0;l<r.length;l+=1){const o=z(t,r,l);a[l]?a[l].p(o,e):(a[l]=rt(o),a[l].c(),a[l].m(n,null))}for(;l<a.length;l+=1)a[l].d(1);a.length=r.length}},d(t){t&&h(e),t&&h(n),U(a,t)}}}function nt(t){let e,n,r={ctx:t,current:null,token:null,hasCatch:!0,pending:dt,then:lt,catch:at,error:23};return J(n=t[4],r),{c(){e=W(),r.block.c()},l(t){e=W(),r.block.l(t)},m(t,n){v(t,e,n),r.block.m(t,r.anchor=n),r.mount=()=>e.parentNode,r.anchor=e},p(e,a){t=e,r.ctx=t,16&a&&n!==(n=t[4])&&J(n,r)||H(r,t,a)},d(t){t&&h(e),r.block.d(t),r.token=null,r=null}}}function rt(t){let e,n,r=t[23]+"";return{c(){e=u("li"),n=E(r)},l(t){e=d(t,"LI",{});var a=f(e);n=_(a,r),a.forEach(h)},m(t,r){v(t,e,r),P(e,n)},p(t,e){64&e&&r!==(r=t[23]+"")&&q(n,r)},d(t){t&&h(e)}}}function at(t){let e,n,r=t[23]+"";return{c(){e=u("pre"),n=E(r)},l(t){e=d(t,"PRE",{});var a=f(e);n=_(a,r),a.forEach(h)},m(t,r){v(t,e,r),P(e,n)},p(t,e){16&e&&r!==(r=t[23]+"")&&q(n,r)},d(t){t&&h(e)}}}function lt(t){let e,n,r={ctx:t,current:null,token:null,hasCatch:!0,pending:ut,then:st,catch:ot,value:22,error:23};return J(n=t[5],r),{c(){e=W(),r.block.c()},l(t){e=W(),r.block.l(t)},m(t,n){v(t,e,n),r.block.m(t,r.anchor=n),r.mount=()=>e.parentNode,r.anchor=e},p(e,a){t=e,r.ctx=t,32&a&&n!==(n=t[5])&&J(n,r)||H(r,t,a)},d(t){t&&h(e),r.block.d(t),r.token=null,r=null}}}function ot(t){let e,n,r=t[23]+"";return{c(){e=u("pre"),n=E(r)},l(t){e=d(t,"PRE",{});var a=f(e);n=_(a,r),a.forEach(h)},m(t,r){v(t,e,r),P(e,n)},p(t,e){32&e&&r!==(r=t[23]+"")&&q(n,r)},d(t){t&&h(e)}}}function st(t){let e;function n(t,e){return"Tree"==t[22].type?ct:it}let r=n(t),a=r(t);return{c(){a.c(),e=W()},l(t){a.l(t),e=W()},m(t,n){a.m(t,n),v(t,e,n)},p(t,l){r===(r=n(t))&&a?a.p(t,l):(a.d(1),a=r(t),a&&(a.c(),a.m(e.parentNode,e)))},d(t){a.d(t),t&&h(e)}}}function it(t){let e,n=t[22]+"";return{c(){e=E(n)},l(t){e=_(t,n)},m(t,n){v(t,e,n)},p(t,r){32&r&&n!==(n=t[22]+"")&&q(e,n)},d(t){t&&h(e)}}}function ct(t){let e,n,r=t[22].pretty()+"";return{c(){e=u("pre"),n=E(r)},l(t){e=d(t,"PRE",{});var a=f(e);n=_(a,r),a.forEach(h)},m(t,r){v(t,e,r),P(e,n)},p(t,e){32&e&&r!==(r=t[22].pretty()+"")&&q(n,r)},d(t){t&&h(e)}}}function ut(t){let e;return{c(){e=E("Parsing...")},l(t){e=_(t,"Parsing...")},m(t,n){v(t,e,n)},p:m,d(t){t&&h(e)}}}function dt(t){let e;return{c(){e=E("Building Parser...")},l(t){e=_(t,"Building Parser...")},m(t,n){v(t,e,n)},p:m,d(t){t&&h(e)}}}function ft(t){let e,n,r,a,l,o,s,i,c,p,m,g,y,B,q,J,W,H,X,F;function Q(e){t[12](e)}let Y={};function z(e){t[14](e)}void 0!==t[1]&&(Y.options=t[1]),l=new Z({props:Y}),x.push((()=>O(l,"options",Q)));let rt={id:"grammar"};void 0!==t[0]&&(rt.text=t[0]),i=new K({props:rt}),t[13](i),x.push((()=>O(i,"text",z))),i.$on("ready",t[10]);let at=t[9],lt=[];for(let u=0;u<at.length;u+=1)lt[u]=tt(G(t,at,u));function ot(t,e){return t[3]?nt:et}let st=ot(t),it=st(t);return{c(){e=$(),n=u("section"),r=u("div"),a=u("div"),w(l.$$.fragment),s=$(),w(i.$$.fragment),p=$(),m=u("div"),g=E("Load grammar:\n\t\t\t"),y=u("select");for(let t=0;t<lt.length;t+=1)lt[t].c();B=$(),q=u("textarea"),J=$(),W=u("div"),it.c(),this.h()},l(t){j('[data-svelte="svelte-3fm5e0"]',document.head).forEach(h),e=b(t),n=d(t,"SECTION",{id:!0,class:!0});var o=f(n);r=d(o,"DIV",{id:!0,class:!0});var c=f(r);a=d(c,"DIV",{id:!0,class:!0});var u=f(a);D(l.$$.fragment,u),u.forEach(h),s=b(c),D(i.$$.fragment,c),p=b(c),m=d(c,"DIV",{});var v=f(m);g=_(v,"Load grammar:\n\t\t\t"),y=d(v,"SELECT",{});var x=f(y);for(let e=0;e<lt.length;e+=1)lt[e].l(x);x.forEach(h),v.forEach(h),c.forEach(h),B=b(o),q=d(o,"TEXTAREA",{id:!0,class:!0}),f(q).forEach(h),J=b(o),W=d(o,"DIV",{id:!0,class:!0});var E=f(W);it.l(E),E.forEach(h),o.forEach(h),this.h()},h(){document.title="Lark IDE",k(a,"id","options"),k(a,"class","svelte-17fyc71"),void 0===t[7]&&V((()=>t[15].call(y))),k(r,"id","grammar_pane"),k(r,"class","svelte-17fyc71"),k(q,"id","text"),k(q,"class","svelte-17fyc71"),k(W,"id","output"),k(W,"class","svelte-17fyc71"),k(n,"id","ide"),k(n,"class","svelte-17fyc71")},m(o,c){v(o,e,c),v(o,n,c),P(n,r),P(r,a),A(l,a,null),P(r,s),A(i,r,null),P(r,p),P(r,m),P(m,g),P(m,y);for(let t=0;t<lt.length;t+=1)lt[t].m(y,null);N(y,t[7]),P(n,B),P(n,q),R(q,t[2]),P(n,J),P(n,W),it.m(W,null),H=!0,X||(F=[L(y,"change",t[15]),L(y,"change",t[11]),L(q,"input",t[16])],X=!0)},p(t,[e]){const n={};!o&&2&e&&(o=!0,n.options=t[1],T((()=>o=!1))),l.$set(n);const r={};if(!c&&1&e&&(c=!0,r.text=t[0],T((()=>c=!1))),i.$set(r),512&e){let n;for(at=t[9],n=0;n<at.length;n+=1){const r=G(t,at,n);lt[n]?lt[n].p(r,e):(lt[n]=tt(r),lt[n].c(),lt[n].m(y,null))}for(;n<lt.length;n+=1)lt[n].d(1);lt.length=at.length}640&e&&N(y,t[7]),4&e&&R(q,t[2]),st===(st=ot(t))&&it?it.p(t,e):(it.d(1),it=st(t),it&&(it.c(),it.m(W,null)))},i(t){H||(C(l.$$.fragment,t),C(i.$$.fragment,t),H=!0)},o(t){S(l.$$.fragment,t),S(i.$$.fragment,t),H=!1},d(r){r&&h(e),r&&h(n),M(l),t[13](null),M(i),U(lt,r),it.d(),X=!1,I(F)}}}const ht=!0;function pt(t,e,n){let r;var a=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(a,l){function o(t){try{i(r.next(t))}catch(e){l(e)}}function s(t){try{i(r.throw(t))}catch(e){l(e)}}function i(t){var e;t.done?a(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}i((r=r.apply(t,e||[])).next())}))};const l={parser:"earley"},o=[{title:"(easy) Hello World",name:"hello",text:"Hello, World!"},{title:"(easy) JSON parser",name:"json",text:'{"this": ["is", "JSON"]}',options:{parser:"lalr"}},{title:"(easy) Calculator",name:"calc",text:"20 / (13 - 6) + 1",options:{parser:"lalr"}}];let s,i,{grammar:c,options:u,text:d}=o[0];u=u||l;let f=[];let h,p="hello";function v(){return a(this,void 0,void 0,(function*(){console.log("Loading grammar",p);let t=yield fetch("grammars/"+p+".lark");if(t.ok){n(0,c=yield t.text()),h.set_text(c);for(let t of o)if(t.name===p){n(2,d=t.text),n(1,u=t.options||l);break}}}))}return t.$$.update=()=>{var e,a,l;11&t.$$.dirty&&n(4,r=i&&(e=c,a=u,i.globals.set("grammar",e),i.globals.set("options",a),i.runPythonAsync("parser = lark.Lark(grammar, **options.to_py())"))),28&t.$$.dirty&&n(5,s=i&&r&&(l=d,i.globals.set("text",l),i.runPythonAsync("parser.parse(text)")))},[c,u,d,i,r,s,f,p,h,o,function(){return a(this,void 0,void 0,(function*(){var t,e;v(),i||(t=t=>{n(3,i=t)},(e=t=>{n(6,f=[...f,t])})&&e("Loading Pyodide"),require(["https://cdn.jsdelivr.net/pyodide/v0.18.0/full/pyodide.js"],(n=>{n.loadPyodide({indexURL:"https://cdn.jsdelivr.net/pyodide/v0.18.0/full/"}).then((async n=>{console.log("Pyodide loaded",n),e&&e("Installing micropip"),await n.loadPackage("micropip"),e&&e("Downloading & Installing Lark"),await n.runPythonAsync("import micropip; await micropip.install('lark-parser');"),n.runPython("import lark"),t(n),console.log("Ready!",n)}))})))}))},v,function(t){u=t,n(1,u)},function(t){x[t?"unshift":"push"]((()=>{h=t,n(8,h)}))},function(t){c=t,n(0,c)},function(){p=B(this),n(7,p),n(9,o)},function(){d=this.value,n(2,d)}]}class vt extends s{constructor(t){super(),i(this,t,pt,ft,c,{})}}export{vt as default,ht as prerender};
