var t=Object.defineProperty,e=Object.defineProperties,n=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,o=(e,n,l)=>n in e?t(e,n,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[n]=l;import{S as s,i as c,s as i,e as u,c as h,a as d,d as f,b as p,f as v,F as m,r as g,u as $,w as y,x as E,t as x,g as b,h as k,K as P,l as _,k as w,n as I,j as L,m as D,o as O,v as V,L as N,M as A,J as j,N as S,O as T,A as q,P as C,Q as R,R as B,T as U,U as M,V as J,W,X as G,Y as H,Z as X,_ as F}from"../chunks/vendor-be96c903.js";function K(t,e,n){const l=t.slice();return l[4]=e[n],l}function Q(t){let e,n;return{c(){e=u("code"),n=x(t[0]),this.h()},l(l){e=h(l,"CODE",{class:!0});var r=d(e);n=b(r,t[0]),r.forEach(f),this.h()},h(){p(e,"class","svelte-sgqldn")},m(t,l){v(t,e,l),m(e,n)},p(t,e){1&e&&k(n,t[0])},i:P,o:P,d(t){t&&f(e)}}}function Y(t){let e,n,l,r;const a=[z,Z],o=[];function s(t,e){return t[0].children.length?0:1}return e=s(t),n=o[e]=a[e](t),{c(){n.c(),l=_()},l(t){n.l(t),l=_()},m(t,n){o[e].m(t,n),v(t,l,n),r=!0},p(t,r){let c=e;e=s(t),e===c?o[e].p(t,r):(g(),$(o[c],1,1,(()=>{o[c]=null})),y(),n=o[e],n?n.p(t,r):(n=o[e]=a[e](t),n.c()),E(n,1),n.m(l.parentNode,l))},i(t){r||(E(n),r=!0)},o(t){$(n),r=!1},d(t){o[e].d(t),t&&f(l)}}}function Z(t){let e,n,l,r,a=t[0].data+"";return{c(){e=u("span"),n=u("span"),l=w(),r=x(a),this.h()},l(t){e=h(t,"SPAN",{});var o=d(e);n=h(o,"SPAN",{class:!0}),d(n).forEach(f),l=I(o),r=b(o,a),o.forEach(f),this.h()},h(){p(n,"class","no-arrow svelte-sgqldn")},m(t,a){v(t,e,a),m(e,n),m(e,l),m(e,r)},p(t,e){1&e&&a!==(a=t[0].data+"")&&k(r,a)},i:P,o:P,d(t){t&&f(e)}}}function z(t){let e,n,l,r,a,o,s,c,i,P,L,D=t[0].data+"",O=t[1]&&tt(t);return{c(){e=u("span"),n=u("span"),l=x("▶"),r=w(),a=u("span"),o=x(D),s=w(),O&&O.c(),c=_(),this.h()},l(t){e=h(t,"SPAN",{});var i=d(e);n=h(i,"SPAN",{class:!0});var u=d(n);l=b(u,"▶"),u.forEach(f),r=I(i),a=h(i,"SPAN",{class:!0});var p=d(a);o=b(p,D),p.forEach(f),i.forEach(f),s=I(t),O&&O.l(t),c=_(),this.h()},h(){p(n,"class","arrow svelte-sgqldn"),A(n,"arrowDown",t[2]),p(a,"class","label svelte-sgqldn")},m(u,h){v(u,e,h),m(e,n),m(n,l),m(e,r),m(e,a),m(a,o),v(u,s,h),O&&O.m(u,h),v(u,c,h),i=!0,P||(L=j(e,"click",t[3]),P=!0)},p(t,e){4&e&&A(n,"arrowDown",t[2]),(!i||1&e)&&D!==(D=t[0].data+"")&&k(o,D),t[1]?O?(O.p(t,e),2&e&&E(O,1)):(O=tt(t),O.c(),E(O,1),O.m(c.parentNode,c)):O&&(g(),$(O,1,1,(()=>{O=null})),y())},i(t){i||(E(O),i=!0)},o(t){$(O),i=!1},d(t){t&&f(e),t&&f(s),O&&O.d(t),t&&f(c),P=!1,L()}}}function tt(t){let e,n,l=[...t[0].children],r=[];for(let o=0;o<l.length;o+=1)r[o]=et(K(t,l,o));const a=t=>$(r[t],1,1,(()=>{r[t]=null}));return{c(){e=u("div");for(let t=0;t<r.length;t+=1)r[t].c();this.h()},l(t){e=h(t,"DIV",{class:!0});var n=d(e);for(let e=0;e<r.length;e+=1)r[e].l(n);n.forEach(f),this.h()},h(){p(e,"class","children")},m(t,l){v(t,e,l);for(let n=0;n<r.length;n+=1)r[n].m(e,null);n=!0},p(t,n){if(1&n){let o;for(l=[...t[0].children],o=0;o<l.length;o+=1){const a=K(t,l,o);r[o]?(r[o].p(a,n),E(r[o],1)):(r[o]=et(a),r[o].c(),E(r[o],1),r[o].m(e,null))}for(g(),o=l.length;o<r.length;o+=1)a(o);y()}},i(t){if(!n){for(let t=0;t<l.length;t+=1)E(r[t]);n=!0}},o(t){r=r.filter(Boolean);for(let e=0;e<r.length;e+=1)$(r[e]);n=!1},d(t){t&&f(e),N(r,t)}}}function et(t){let e,n;return e=new rt({props:{tree:t[4]}}),{c(){L(e.$$.fragment)},l(t){D(e.$$.fragment,t)},m(t,l){O(e,t,l),n=!0},p(t,n){const l={};1&n&&(l.tree=t[4]),e.$set(l)},i(t){n||(E(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){V(e,t)}}}function nt(t){let e,n,l,r,a;const o=[Y,Q],s=[];function c(t,e){return"Tree"===t[0].type?0:1}return l=c(t),r=s[l]=o[l](t),{c(){e=u("ul"),n=u("li"),r.c(),this.h()},l(t){e=h(t,"UL",{class:!0});var l=d(e);n=h(l,"LI",{});var a=d(n);r.l(a),a.forEach(f),l.forEach(f),this.h()},h(){p(e,"class","svelte-sgqldn")},m(t,r){v(t,e,r),m(e,n),s[l].m(n,null),a=!0},p(t,[e]){let a=l;l=c(t),l===a?s[l].p(t,e):(g(),$(s[a],1,1,(()=>{s[a]=null})),y(),r=s[l],r?r.p(t,e):(r=s[l]=o[l](t),r.c()),E(r,1),r.m(n,null))},i(t){a||(E(r),a=!0)},o(t){$(r),a=!1},d(t){t&&f(e),s[l].d()}}}function lt(t,e,n){let l,{tree:r}=e,a=!0;return t.$$set=t=>{"tree"in t&&n(0,r=t.tree)},t.$$.update=()=>{2&t.$$.dirty&&n(2,l=a)},[r,a,l,()=>{n(1,a=!a)}]}class rt extends s{constructor(t){super(),c(this,t,lt,nt,i,{tree:0})}}function at(t){let e;return{c(){e=u("div"),this.h()},l(t){e=h(t,"DIV",{style:!0}),d(e).forEach(f),this.h()},h(){S(e,"height","80vh"),S(e,"border","1px solid grey")},m(n,l){v(n,e,l),t[3](e)},p:P,i:P,o:P,d(n){n&&f(e),t[3](null)}}}function ot(t,e,n){const l=T();let r,a,{text:o=""}=e;const s={value:o,language:"ruby",automaticLayout:!0};return q((()=>{require.config({paths:{vs:"https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.26.1/min/vs"}}),require(["vs/editor/editor.main"],(t=>{r=t.editor.create(a,s),n(1,o=r.getModel().getValue()),r.getModel().onDidChangeContent((t=>{n(1,o=r.getModel().getValue())})),l("ready",{})}))})),t.$$set=t=>{"text"in t&&n(1,o=t.text)},[a,o,function(t){if(r)return r.getModel().setValue(t)},function(t){C[t?"unshift":"push"]((()=>{a=t,n(0,a)}))}]}class st extends s{constructor(t){super(),c(this,t,ot,at,i,{text:1,set_text:2})}get set_text(){return this.$$.ctx[2]}}function ct(t){let e,n,l,r,a,o,s,c,i,g,$,y,E,k,_,L,D,O;return{c(){e=u("div"),n=u("div"),l=u("div"),r=x("Parser:"),a=w(),o=u("div"),s=u("input"),c=w(),i=u("label"),g=x("Earley"),$=w(),y=u("div"),E=u("input"),k=w(),_=u("label"),L=x("LALR(1)"),this.h()},l(t){e=h(t,"DIV",{id:!0});var u=d(e);n=h(u,"DIV",{class:!0});var p=d(n);l=h(p,"DIV",{});var v=d(l);r=b(v,"Parser:"),v.forEach(f),a=I(p),o=h(p,"DIV",{});var m=d(o);s=h(m,"INPUT",{type:!0,id:!0,name:!0}),c=I(m),i=h(m,"LABEL",{for:!0});var x=d(i);g=b(x,"Earley"),x.forEach(f),m.forEach(f),$=I(p),y=h(p,"DIV",{});var P=d(y);E=h(P,"INPUT",{type:!0,id:!0,name:!0}),k=I(P),_=h(P,"LABEL",{for:!0});var w=d(_);L=b(w,"LALR(1)"),w.forEach(f),P.forEach(f),p.forEach(f),u.forEach(f),this.h()},h(){p(s,"type","radio"),p(s,"id","earley"),p(s,"name","parser"),s.__value="earley",s.value=s.__value,s.checked=!0,t[4][0].push(s),p(i,"for","earley"),p(E,"type","radio"),p(E,"id","lalr"),p(E,"name","parser"),E.__value="lalr",E.value=E.__value,t[4][0].push(E),p(_,"for","lalr"),p(n,"class","option svelte-fi2lts"),p(e,"id","options")},m(u,h){v(u,e,h),m(e,n),m(n,l),m(l,r),m(n,a),m(n,o),m(o,s),s.checked=s.__value===t[0],m(o,c),m(o,i),m(i,g),m(n,$),m(n,y),m(y,E),E.checked=E.__value===t[0],m(y,k),m(y,_),m(_,L),D||(O=[j(s,"input",t[1]),j(s,"change",t[3]),j(E,"input",t[1]),j(E,"change",t[5])],D=!0)},p(t,[e]){1&e&&(s.checked=s.__value===t[0]),1&e&&(E.checked=E.__value===t[0])},i:P,o:P,d(n){n&&f(e),t[4][0].splice(t[4][0].indexOf(s),1),t[4][0].splice(t[4][0].indexOf(E),1),D=!1,R(O)}}}function it(t,s,c){let i,{options:u}=s;return t.$$set=t=>{"options"in t&&c(2,u=t.options)},t.$$.update=()=>{4&t.$$.dirty&&u&&c(0,i=u.parser)},[i,function(t){var s,i;c(2,(s=((t,e)=>{for(var n in e||(e={}))r.call(e,n)&&o(t,n,e[n]);if(l)for(var n of l(e))a.call(e,n)&&o(t,n,e[n]);return t})({},u),i={parser:t.target.value},u=e(s,n(i))))},u,function(){i=this.__value,c(0,i)},[[]],function(){i=this.__value,c(0,i)}]}class ut extends s{constructor(t){super(),c(this,t,it,ct,i,{options:2})}}function ht(t,e,n){const l=t.slice();return l[23]=e[n],l}function dt(t,e,n){const l=t.slice();return l[26]=e[n],l}function ft(t){let e,n,l,r,a=t[26].title+"";return{c(){e=u("option"),n=x(a),l=w(),this.h()},l(t){e=h(t,"OPTION",{});var r=d(e);n=b(r,a),l=I(r),r.forEach(f),this.h()},h(){e.__value=r=t[26].name,e.value=e.__value},m(t,r){v(t,e,r),m(e,n),m(e,l)},p:P,d(t){t&&f(e)}}}function pt(t){let e,n,l=t[6],r=[];for(let a=0;a<l.length;a+=1)r[a]=mt(ht(t,l,a));return{c(){e=x("Please wait, loading...\n\t\t"),n=u("ul");for(let t=0;t<r.length;t+=1)r[t].c()},l(t){e=b(t,"Please wait, loading...\n\t\t"),n=h(t,"UL",{});var l=d(n);for(let e=0;e<r.length;e+=1)r[e].l(l);l.forEach(f)},m(t,l){v(t,e,l),v(t,n,l);for(let e=0;e<r.length;e+=1)r[e].m(n,null)},p(t,e){if(64&e){let a;for(l=t[6],a=0;a<l.length;a+=1){const o=ht(t,l,a);r[a]?r[a].p(o,e):(r[a]=mt(o),r[a].c(),r[a].m(n,null))}for(;a<r.length;a+=1)r[a].d(1);r.length=l.length}},i:P,o:P,d(t){t&&f(e),t&&f(n),N(r,t)}}}function vt(t){let e,n,l,r={ctx:t,current:null,token:null,hasCatch:!0,pending:bt,then:$t,catch:gt,error:23,blocks:[,,,]};return X(n=t[4],r),{c(){e=_(),r.block.c()},l(t){e=_(),r.block.l(t)},m(t,n){v(t,e,n),r.block.m(t,r.anchor=n),r.mount=()=>e.parentNode,r.anchor=e,l=!0},p(e,l){t=e,r.ctx=t,16&l&&n!==(n=t[4])&&X(n,r)||F(r,t,l)},i(t){l||(E(r.block),l=!0)},o(t){for(let e=0;e<3;e+=1){const t=r.blocks[e];$(t)}l=!1},d(t){t&&f(e),r.block.d(t),r.token=null,r=null}}}function mt(t){let e,n,l=t[23]+"";return{c(){e=u("li"),n=x(l)},l(t){e=h(t,"LI",{});var r=d(e);n=b(r,l),r.forEach(f)},m(t,l){v(t,e,l),m(e,n)},p(t,e){64&e&&l!==(l=t[23]+"")&&k(n,l)},d(t){t&&f(e)}}}function gt(t){let e,n,l=t[23]+"";return{c(){e=u("pre"),n=x(l)},l(t){e=h(t,"PRE",{});var r=d(e);n=b(r,l),r.forEach(f)},m(t,l){v(t,e,l),m(e,n)},p(t,e){16&e&&l!==(l=t[23]+"")&&k(n,l)},i:P,o:P,d(t){t&&f(e)}}}function $t(t){let e,n,l,r={ctx:t,current:null,token:null,hasCatch:!0,pending:xt,then:Et,catch:yt,value:22,error:23,blocks:[,,,]};return X(n=t[5],r),{c(){e=_(),r.block.c()},l(t){e=_(),r.block.l(t)},m(t,n){v(t,e,n),r.block.m(t,r.anchor=n),r.mount=()=>e.parentNode,r.anchor=e,l=!0},p(e,l){t=e,r.ctx=t,32&l&&n!==(n=t[5])&&X(n,r)||F(r,t,l)},i(t){l||(E(r.block),l=!0)},o(t){for(let e=0;e<3;e+=1){const t=r.blocks[e];$(t)}l=!1},d(t){t&&f(e),r.block.d(t),r.token=null,r=null}}}function yt(t){let e,n,l=t[23]+"";return{c(){e=u("pre"),n=x(l)},l(t){e=h(t,"PRE",{});var r=d(e);n=b(r,l),r.forEach(f)},m(t,l){v(t,e,l),m(e,n)},p(t,e){32&e&&l!==(l=t[23]+"")&&k(n,l)},i:P,o:P,d(t){t&&f(e)}}}function Et(t){let e,n;return e=new rt({props:{tree:t[22]}}),{c(){L(e.$$.fragment)},l(t){D(e.$$.fragment,t)},m(t,l){O(e,t,l),n=!0},p(t,n){const l={};32&n&&(l.tree=t[22]),e.$set(l)},i(t){n||(E(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){V(e,t)}}}function xt(t){let e;return{c(){e=x("Parsing...")},l(t){e=b(t,"Parsing...")},m(t,n){v(t,e,n)},p:P,i:P,o:P,d(t){t&&f(e)}}}function bt(t){let e;return{c(){e=x("Building Parser...")},l(t){e=b(t,"Building Parser...")},m(t,n){v(t,e,n)},p:P,i:P,o:P,d(t){t&&f(e)}}}function kt(t){let e,n,l,r,a,o,s,c,i,k,P,_,A,S,T,q,H,X,F,K,Q,Y,Z,z,tt;function et(e){t[12](e)}let nt={};void 0!==t[1]&&(nt.options=t[1]),a=new ut({props:nt}),C.push((()=>B(a,"options",et)));let lt=t[9],rt=[];for(let u=0;u<lt.length;u+=1)rt[u]=ft(dt(t,lt,u));function at(e){t[15](e)}let ot={id:"grammar"};void 0!==t[0]&&(ot.text=t[0]),T=new st({props:ot}),t[14](T),C.push((()=>B(T,"text",at))),T.$on("ready",t[10]);const ct=[vt,pt],it=[];function ht(t,e){return t[3]?0:1}return Q=ht(t),Y=it[Q]=ct[Q](t),{c(){e=w(),n=u("section"),l=u("div"),r=u("div"),L(a.$$.fragment),s=w(),c=u("div"),i=u("div"),k=u("div"),P=x("Load Grammar:"),_=w(),A=u("select");for(let t=0;t<rt.length;t+=1)rt[t].c();S=w(),L(T.$$.fragment),H=w(),X=u("textarea"),F=w(),K=u("div"),Y.c(),this.h()},l(t){U('[data-svelte="svelte-3fm5e0"]',document.head).forEach(f),e=I(t),n=h(t,"SECTION",{id:!0,class:!0});var o=d(n);l=h(o,"DIV",{id:!0,class:!0});var u=d(l);r=h(u,"DIV",{id:!0,class:!0});var p=d(r);D(a.$$.fragment,p),p.forEach(f),s=I(u),c=h(u,"DIV",{id:!0,class:!0});var v=d(c);i=h(v,"DIV",{class:!0});var m=d(i);k=h(m,"DIV",{});var g=d(k);P=b(g,"Load Grammar:"),g.forEach(f),_=I(m),A=h(m,"SELECT",{class:!0});var $=d(A);for(let e=0;e<rt.length;e+=1)rt[e].l($);$.forEach(f),m.forEach(f),v.forEach(f),S=I(u),D(T.$$.fragment,u),u.forEach(f),H=I(o),X=h(o,"TEXTAREA",{id:!0,class:!0}),d(X).forEach(f),F=I(o),K=h(o,"DIV",{id:!0,class:!0});var y=d(K);Y.l(y),y.forEach(f),o.forEach(f),this.h()},h(){document.title="Lark IDE",p(r,"id","options"),p(r,"class","svelte-99vlcc"),p(A,"class","svelte-99vlcc"),void 0===t[7]&&M((()=>t[13].call(A))),p(i,"class","option svelte-99vlcc"),p(c,"id","load-grammar"),p(c,"class","svelte-99vlcc"),p(l,"id","grammar_pane"),p(l,"class","svelte-99vlcc"),p(X,"id","text"),p(X,"class","svelte-99vlcc"),p(K,"id","output"),p(K,"class","svelte-99vlcc"),p(n,"id","ide"),p(n,"class","svelte-99vlcc")},m(o,u){v(o,e,u),v(o,n,u),m(n,l),m(l,r),O(a,r,null),m(l,s),m(l,c),m(c,i),m(i,k),m(k,P),m(i,_),m(i,A);for(let t=0;t<rt.length;t+=1)rt[t].m(A,null);J(A,t[7]),m(l,S),O(T,l,null),m(n,H),m(n,X),W(X,t[2]),m(n,F),m(n,K),it[Q].m(K,null),Z=!0,z||(tt=[j(A,"change",t[13]),j(A,"change",t[11]),j(X,"input",t[16])],z=!0)},p(t,[e]){const n={};if(!o&&2&e&&(o=!0,n.options=t[1],G((()=>o=!1))),a.$set(n),512&e){let n;for(lt=t[9],n=0;n<lt.length;n+=1){const l=dt(t,lt,n);rt[n]?rt[n].p(l,e):(rt[n]=ft(l),rt[n].c(),rt[n].m(A,null))}for(;n<rt.length;n+=1)rt[n].d(1);rt.length=lt.length}640&e&&J(A,t[7]);const l={};!q&&1&e&&(q=!0,l.text=t[0],G((()=>q=!1))),T.$set(l),4&e&&W(X,t[2]);let r=Q;Q=ht(t),Q===r?it[Q].p(t,e):(g(),$(it[r],1,1,(()=>{it[r]=null})),y(),Y=it[Q],Y?Y.p(t,e):(Y=it[Q]=ct[Q](t),Y.c()),E(Y,1),Y.m(K,null))},i(t){Z||(E(a.$$.fragment,t),E(T.$$.fragment,t),E(Y),Z=!0)},o(t){$(a.$$.fragment,t),$(T.$$.fragment,t),$(Y),Z=!1},d(l){l&&f(e),l&&f(n),V(a),N(rt,l),t[14](null),V(T),it[Q].d(),z=!1,R(tt)}}}const Pt=!0;function _t(t,e,n){let l;var r=this&&this.__awaiter||function(t,e,n,l){return new(n||(n=Promise))((function(r,a){function o(t){try{c(l.next(t))}catch(e){a(e)}}function s(t){try{c(l.throw(t))}catch(e){a(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}c((l=l.apply(t,e||[])).next())}))};const a={parser:"earley"},o=[{title:"Blank",name:"blank",text:""},{title:"(easy) Hello World",name:"hello",text:"Hello, World!"},{title:"(easy) JSON parser",name:"json",text:'{"this": ["is", "JSON"]}',options:{parser:"lalr"}},{title:"(easy) Calculator",name:"calc",text:"20 / (13 - 6) + 1",options:{parser:"lalr"}}];let s,c,{grammar:i,options:u,text:h}=o[1];u=u||a;let d=[];let f,p="hello";function v(){return r(this,void 0,void 0,(function*(){if(console.log("Loading grammar",p),"blank"===p)return n(2,h=""),n(0,i=""),f.set_text(""),void n(1,u=a);let t=yield fetch("grammars/"+p+".lark");if(t.ok){n(0,i=yield t.text()),f.set_text(i);for(let t of o)if(t.name===p){n(2,h=t.text),n(1,u=t.options||a);break}}}))}return t.$$.update=()=>{var e,r,a;11&t.$$.dirty&&n(4,l=c&&(e=i,r=u,c.globals.set("grammar",e),c.globals.set("options",r),c.runPythonAsync("parser = lark.Lark(grammar, **options.to_py())"))),28&t.$$.dirty&&n(5,s=c&&l&&(a=h,c.globals.set("text",a),c.runPythonAsync("parser.parse(text)")))},[i,u,h,c,l,s,d,p,f,o,function(){return r(this,void 0,void 0,(function*(){var t,e;v(),c||(t=t=>{n(3,c=t)},(e=t=>{n(6,d=[...d,t])})&&e("Loading Pyodide"),require(["https://cdn.jsdelivr.net/pyodide/v0.18.0/full/pyodide.js"],(n=>{n.loadPyodide({indexURL:"https://cdn.jsdelivr.net/pyodide/v0.18.0/full/"}).then((async n=>{console.log("Pyodide loaded",n),e&&e("Installing micropip"),await n.loadPackage("micropip"),e&&e("Downloading & Installing Lark"),await n.runPythonAsync("import micropip; await micropip.install('lark-parser');"),n.runPython("import lark"),t(n),console.log("Ready!",n)}))})))}))},v,function(t){u=t,n(1,u)},function(){p=H(this),n(7,p),n(9,o)},function(t){C[t?"unshift":"push"]((()=>{f=t,n(8,f)}))},function(t){i=t,n(0,i)},function(){h=this.value,n(2,h)}]}class wt extends s{constructor(t){super(),c(this,t,_t,kt,i,{})}}export{wt as default,Pt as prerender};
