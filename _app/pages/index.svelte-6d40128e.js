var t=Object.defineProperty,e=Object.defineProperties,n=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,o=(e,n,a)=>n in e?t(e,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[n]=a;import{S as s,i as c,s as i,e as u,c as d,a as h,d as f,K as p,f as v,J as m,L as g,A as y,M as x,t as E,k as $,g as k,n as _,b,F as P,N as I,O as L,P as O,j as w,Q as D,m as V,R as j,o as A,T as N,U as R,V as T,x as C,u as S,v as B,W as M,X as U,h as q,Y as J,l as W,Z as G}from"../chunks/vendor-8f9d1cf9.js";function H(t){let e;return{c(){e=u("div"),this.h()},l(t){e=d(t,"DIV",{style:!0}),h(e).forEach(f),this.h()},h(){p(e,"height","80vh"),p(e,"border","1px solid grey")},m(n,a){v(n,e,a),t[3](e)},p:m,i:m,o:m,d(n){n&&f(e),t[3](null)}}}function X(t,e,n){const a=g();let r,l,{text:o=""}=e;const s={value:o,language:"ruby",automaticLayout:!0};return y((()=>{require.config({paths:{vs:"https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.26.1/min/vs"}}),require(["vs/editor/editor.main"],(t=>{r=t.editor.create(l,s),n(1,o=r.getModel().getValue()),r.getModel().onDidChangeContent((t=>{n(1,o=r.getModel().getValue())})),a("ready",{})}))})),t.$$set=t=>{"text"in t&&n(1,o=t.text)},[l,o,function(t){if(r)return r.getModel().setValue(t)},function(t){x[t?"unshift":"push"]((()=>{l=t,n(0,l)}))}]}class F extends s{constructor(t){super(),c(this,t,X,H,i,{text:1,set_text:2})}get set_text(){return this.$$.ctx[2]}}function K(t){let e,n,a,r,l,o,s,c,i,p,g,y,x,O,w,D,V,j;return{c(){e=u("div"),n=u("div"),a=u("div"),r=E("Parser:"),l=$(),o=u("div"),s=u("input"),c=$(),i=u("label"),p=E("Earley"),g=$(),y=u("div"),x=u("input"),O=$(),w=u("label"),D=E("LALR(1)"),this.h()},l(t){e=d(t,"DIV",{id:!0});var u=h(e);n=d(u,"DIV",{class:!0});var v=h(n);a=d(v,"DIV",{});var m=h(a);r=k(m,"Parser:"),m.forEach(f),l=_(v),o=d(v,"DIV",{});var E=h(o);s=d(E,"INPUT",{type:!0,id:!0,name:!0}),c=_(E),i=d(E,"LABEL",{for:!0});var $=h(i);p=k($,"Earley"),$.forEach(f),E.forEach(f),g=_(v),y=d(v,"DIV",{});var b=h(y);x=d(b,"INPUT",{type:!0,id:!0,name:!0}),O=_(b),w=d(b,"LABEL",{for:!0});var P=h(w);D=k(P,"LALR(1)"),P.forEach(f),b.forEach(f),v.forEach(f),u.forEach(f),this.h()},h(){b(s,"type","radio"),b(s,"id","earley"),b(s,"name","parser"),s.__value="earley",s.value=s.__value,s.checked=!0,t[4][0].push(s),b(i,"for","earley"),b(x,"type","radio"),b(x,"id","lalr"),b(x,"name","parser"),x.__value="lalr",x.value=x.__value,t[4][0].push(x),b(w,"for","lalr"),b(n,"class","option svelte-fi2lts"),b(e,"id","options")},m(u,d){v(u,e,d),P(e,n),P(n,a),P(a,r),P(n,l),P(n,o),P(o,s),s.checked=s.__value===t[0],P(o,c),P(o,i),P(i,p),P(n,g),P(n,y),P(y,x),x.checked=x.__value===t[0],P(y,O),P(y,w),P(w,D),V||(j=[I(s,"input",t[1]),I(s,"change",t[3]),I(x,"input",t[1]),I(x,"change",t[5])],V=!0)},p(t,[e]){1&e&&(s.checked=s.__value===t[0]),1&e&&(x.checked=x.__value===t[0])},i:m,o:m,d(n){n&&f(e),t[4][0].splice(t[4][0].indexOf(s),1),t[4][0].splice(t[4][0].indexOf(x),1),V=!1,L(j)}}}function Q(t,s,c){let i,{options:u}=s;return t.$$set=t=>{"options"in t&&c(2,u=t.options)},t.$$.update=()=>{4&t.$$.dirty&&u&&c(0,i=u.parser)},[i,function(t){var s,i;c(2,(s=((t,e)=>{for(var n in e||(e={}))r.call(e,n)&&o(t,n,e[n]);if(a)for(var n of a(e))l.call(e,n)&&o(t,n,e[n]);return t})({},u),i={parser:t.target.value},u=e(s,n(i))))},u,function(){i=this.__value,c(0,i)},[[]],function(){i=this.__value,c(0,i)}]}class Y extends s{constructor(t){super(),c(this,t,Q,K,i,{options:2})}}function Z(t,e,n){const a=t.slice();return a[23]=e[n],a}function z(t,e,n){const a=t.slice();return a[26]=e[n],a}function tt(t){let e,n,a,r,l=t[26].title+"";return{c(){e=u("option"),n=E(l),a=$(),this.h()},l(t){e=d(t,"OPTION",{});var r=h(e);n=k(r,l),a=_(r),r.forEach(f),this.h()},h(){e.__value=r=t[26].name,e.value=e.__value},m(t,r){v(t,e,r),P(e,n),P(e,a)},p:m,d(t){t&&f(e)}}}function et(t){let e,n,a=t[6],r=[];for(let l=0;l<a.length;l+=1)r[l]=at(Z(t,a,l));return{c(){e=E("Please wait, loading...\n\t\t"),n=u("ul");for(let t=0;t<r.length;t+=1)r[t].c()},l(t){e=k(t,"Please wait, loading...\n\t\t"),n=d(t,"UL",{});var a=h(n);for(let e=0;e<r.length;e+=1)r[e].l(a);a.forEach(f)},m(t,a){v(t,e,a),v(t,n,a);for(let e=0;e<r.length;e+=1)r[e].m(n,null)},p(t,e){if(64&e){let l;for(a=t[6],l=0;l<a.length;l+=1){const o=Z(t,a,l);r[l]?r[l].p(o,e):(r[l]=at(o),r[l].c(),r[l].m(n,null))}for(;l<r.length;l+=1)r[l].d(1);r.length=a.length}},d(t){t&&f(e),t&&f(n),M(r,t)}}}function nt(t){let e,n,a={ctx:t,current:null,token:null,hasCatch:!0,pending:dt,then:lt,catch:rt,error:23};return J(n=t[4],a),{c(){e=W(),a.block.c()},l(t){e=W(),a.block.l(t)},m(t,n){v(t,e,n),a.block.m(t,a.anchor=n),a.mount=()=>e.parentNode,a.anchor=e},p(e,r){t=e,a.ctx=t,16&r&&n!==(n=t[4])&&J(n,a)||G(a,t,r)},d(t){t&&f(e),a.block.d(t),a.token=null,a=null}}}function at(t){let e,n,a=t[23]+"";return{c(){e=u("li"),n=E(a)},l(t){e=d(t,"LI",{});var r=h(e);n=k(r,a),r.forEach(f)},m(t,a){v(t,e,a),P(e,n)},p(t,e){64&e&&a!==(a=t[23]+"")&&q(n,a)},d(t){t&&f(e)}}}function rt(t){let e,n,a=t[23]+"";return{c(){e=u("pre"),n=E(a)},l(t){e=d(t,"PRE",{});var r=h(e);n=k(r,a),r.forEach(f)},m(t,a){v(t,e,a),P(e,n)},p(t,e){16&e&&a!==(a=t[23]+"")&&q(n,a)},d(t){t&&f(e)}}}function lt(t){let e,n,a={ctx:t,current:null,token:null,hasCatch:!0,pending:ut,then:st,catch:ot,value:22,error:23};return J(n=t[5],a),{c(){e=W(),a.block.c()},l(t){e=W(),a.block.l(t)},m(t,n){v(t,e,n),a.block.m(t,a.anchor=n),a.mount=()=>e.parentNode,a.anchor=e},p(e,r){t=e,a.ctx=t,32&r&&n!==(n=t[5])&&J(n,a)||G(a,t,r)},d(t){t&&f(e),a.block.d(t),a.token=null,a=null}}}function ot(t){let e,n,a=t[23]+"";return{c(){e=u("pre"),n=E(a)},l(t){e=d(t,"PRE",{});var r=h(e);n=k(r,a),r.forEach(f)},m(t,a){v(t,e,a),P(e,n)},p(t,e){32&e&&a!==(a=t[23]+"")&&q(n,a)},d(t){t&&f(e)}}}function st(t){let e;function n(t,e){return"Tree"==t[22].type?it:ct}let a=n(t),r=a(t);return{c(){r.c(),e=W()},l(t){r.l(t),e=W()},m(t,n){r.m(t,n),v(t,e,n)},p(t,l){a===(a=n(t))&&r?r.p(t,l):(r.d(1),r=a(t),r&&(r.c(),r.m(e.parentNode,e)))},d(t){r.d(t),t&&f(e)}}}function ct(t){let e,n=t[22]+"";return{c(){e=E(n)},l(t){e=k(t,n)},m(t,n){v(t,e,n)},p(t,a){32&a&&n!==(n=t[22]+"")&&q(e,n)},d(t){t&&f(e)}}}function it(t){let e,n,a=t[22].pretty()+"";return{c(){e=u("pre"),n=E(a)},l(t){e=d(t,"PRE",{});var r=h(e);n=k(r,a),r.forEach(f)},m(t,a){v(t,e,a),P(e,n)},p(t,e){32&e&&a!==(a=t[22].pretty()+"")&&q(n,a)},d(t){t&&f(e)}}}function ut(t){let e;return{c(){e=E("Parsing...")},l(t){e=k(t,"Parsing...")},m(t,n){v(t,e,n)},p:m,d(t){t&&f(e)}}}function dt(t){let e;return{c(){e=E("Building Parser...")},l(t){e=k(t,"Building Parser...")},m(t,n){v(t,e,n)},p:m,d(t){t&&f(e)}}}function ht(t){let e,n,a,r,l,o,s,c,i,p,m,g,y,U,q,J,W,G,H,X,K,Q,Z;function at(e){t[12](e)}let rt={};void 0!==t[1]&&(rt.options=t[1]),l=new Y({props:rt}),x.push((()=>O(l,"options",at)));let lt=t[9],ot=[];for(let u=0;u<lt.length;u+=1)ot[u]=tt(z(t,lt,u));function st(e){t[15](e)}let ct={id:"grammar"};function it(t,e){return t[3]?nt:et}void 0!==t[0]&&(ct.text=t[0]),q=new F({props:ct}),t[14](q),x.push((()=>O(q,"text",st))),q.$on("ready",t[10]);let ut=it(t),dt=ut(t);return{c(){e=$(),n=u("section"),a=u("div"),r=u("div"),w(l.$$.fragment),s=$(),c=u("div"),i=u("div"),p=u("div"),m=E("Load Grammar:"),g=$(),y=u("select");for(let t=0;t<ot.length;t+=1)ot[t].c();U=$(),w(q.$$.fragment),W=$(),G=u("textarea"),H=$(),X=u("div"),dt.c(),this.h()},l(t){D('[data-svelte="svelte-3fm5e0"]',document.head).forEach(f),e=_(t),n=d(t,"SECTION",{id:!0,class:!0});var o=h(n);a=d(o,"DIV",{id:!0,class:!0});var u=h(a);r=d(u,"DIV",{id:!0,class:!0});var v=h(r);V(l.$$.fragment,v),v.forEach(f),s=_(u),c=d(u,"DIV",{id:!0,class:!0});var x=h(c);i=d(x,"DIV",{class:!0});var E=h(i);p=d(E,"DIV",{});var $=h(p);m=k($,"Load Grammar:"),$.forEach(f),g=_(E),y=d(E,"SELECT",{class:!0});var b=h(y);for(let e=0;e<ot.length;e+=1)ot[e].l(b);b.forEach(f),E.forEach(f),x.forEach(f),U=_(u),V(q.$$.fragment,u),u.forEach(f),W=_(o),G=d(o,"TEXTAREA",{id:!0,class:!0}),h(G).forEach(f),H=_(o),X=d(o,"DIV",{id:!0,class:!0});var P=h(X);dt.l(P),P.forEach(f),o.forEach(f),this.h()},h(){document.title="Lark IDE",b(r,"id","options"),b(r,"class","svelte-99vlcc"),b(y,"class","svelte-99vlcc"),void 0===t[7]&&j((()=>t[13].call(y))),b(i,"class","option svelte-99vlcc"),b(c,"id","load-grammar"),b(c,"class","svelte-99vlcc"),b(a,"id","grammar_pane"),b(a,"class","svelte-99vlcc"),b(G,"id","text"),b(G,"class","svelte-99vlcc"),b(X,"id","output"),b(X,"class","svelte-99vlcc"),b(n,"id","ide"),b(n,"class","svelte-99vlcc")},m(o,u){v(o,e,u),v(o,n,u),P(n,a),P(a,r),A(l,r,null),P(a,s),P(a,c),P(c,i),P(i,p),P(p,m),P(i,g),P(i,y);for(let t=0;t<ot.length;t+=1)ot[t].m(y,null);N(y,t[7]),P(a,U),A(q,a,null),P(n,W),P(n,G),R(G,t[2]),P(n,H),P(n,X),dt.m(X,null),K=!0,Q||(Z=[I(y,"change",t[13]),I(y,"change",t[11]),I(G,"input",t[16])],Q=!0)},p(t,[e]){const n={};if(!o&&2&e&&(o=!0,n.options=t[1],T((()=>o=!1))),l.$set(n),512&e){let n;for(lt=t[9],n=0;n<lt.length;n+=1){const a=z(t,lt,n);ot[n]?ot[n].p(a,e):(ot[n]=tt(a),ot[n].c(),ot[n].m(y,null))}for(;n<ot.length;n+=1)ot[n].d(1);ot.length=lt.length}640&e&&N(y,t[7]);const a={};!J&&1&e&&(J=!0,a.text=t[0],T((()=>J=!1))),q.$set(a),4&e&&R(G,t[2]),ut===(ut=it(t))&&dt?dt.p(t,e):(dt.d(1),dt=ut(t),dt&&(dt.c(),dt.m(X,null)))},i(t){K||(C(l.$$.fragment,t),C(q.$$.fragment,t),K=!0)},o(t){S(l.$$.fragment,t),S(q.$$.fragment,t),K=!1},d(a){a&&f(e),a&&f(n),B(l),M(ot,a),t[14](null),B(q),dt.d(),Q=!1,L(Z)}}}const ft=!0;function pt(t,e,n){let a;var r=this&&this.__awaiter||function(t,e,n,a){return new(n||(n=Promise))((function(r,l){function o(t){try{c(a.next(t))}catch(e){l(e)}}function s(t){try{c(a.throw(t))}catch(e){l(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}c((a=a.apply(t,e||[])).next())}))};const l={parser:"earley"},o=[{title:"Blank",name:"blank",text:""},{title:"(easy) Hello World",name:"hello",text:"Hello, World!"},{title:"(easy) JSON parser",name:"json",text:'{"this": ["is", "JSON"]}',options:{parser:"lalr"}},{title:"(easy) Calculator",name:"calc",text:"20 / (13 - 6) + 1",options:{parser:"lalr"}}];let s,c,{grammar:i,options:u,text:d}=o[1];u=u||l;let h=[];let f,p="hello";function v(){return r(this,void 0,void 0,(function*(){if(console.log("Loading grammar",p),"blank"===p)return n(2,d=""),n(0,i=""),f.set_text(""),void n(1,u=l);let t=yield fetch("grammars/"+p+".lark");if(t.ok){n(0,i=yield t.text()),f.set_text(i);for(let t of o)if(t.name===p){n(2,d=t.text),n(1,u=t.options||l);break}}}))}return t.$$.update=()=>{var e,r,l;11&t.$$.dirty&&n(4,a=c&&(e=i,r=u,c.globals.set("grammar",e),c.globals.set("options",r),c.runPythonAsync("parser = lark.Lark(grammar, **options.to_py())"))),28&t.$$.dirty&&n(5,s=c&&a&&(l=d,c.globals.set("text",l),c.runPythonAsync("parser.parse(text)")))},[i,u,d,c,a,s,h,p,f,o,function(){return r(this,void 0,void 0,(function*(){var t,e;v(),c||(t=t=>{n(3,c=t)},(e=t=>{n(6,h=[...h,t])})&&e("Loading Pyodide"),require(["https://cdn.jsdelivr.net/pyodide/v0.18.0/full/pyodide.js"],(n=>{n.loadPyodide({indexURL:"https://cdn.jsdelivr.net/pyodide/v0.18.0/full/"}).then((async n=>{console.log("Pyodide loaded",n),e&&e("Installing micropip"),await n.loadPackage("micropip"),e&&e("Downloading & Installing Lark"),await n.runPythonAsync("import micropip; await micropip.install('lark-parser');"),n.runPython("import lark"),t(n),console.log("Ready!",n)}))})))}))},v,function(t){u=t,n(1,u)},function(){p=U(this),n(7,p),n(9,o)},function(t){x[t?"unshift":"push"]((()=>{f=t,n(8,f)}))},function(t){i=t,n(0,i)},function(){d=this.value,n(2,d)}]}class vt extends s{constructor(t){super(),c(this,t,pt,ht,i,{})}}export{vt as default,ft as prerender};
